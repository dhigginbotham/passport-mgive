<!DOCTYPE html>

<html>
<head>
  <title>index.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>index.coffee</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>written by <a href="david@hillsoft.com">david higginbotham</a> under MIT
for Mobile Accord, Inc. </p>
<p>To provide an easy route to the mGive Public API through Node.js</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
conf = require <span class="string">"../conf"</span>
qs = require <span class="string">"querystring"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2>mGive API Class</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive = () -&gt;</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2>mGive::makeQueryString</h2>
<p>make a query string out of the api routes</p>
<p>  <code>apiRoute</code>  Object  needs an object to create a querystring with</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">makeQueryString</span></span> = (apiRoute) -&gt;

  url = <span class="string">"http://services.mobileaccord.com/api.ashx?responseType=json&amp;"</span>
  <span class="property">@url</span> = url + qs.stringify apiRoute
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2>mGive::persistToken</h2>
<p>persist our sessionId and token once we&#39;ve gotten them</p>
<p>  <code>accessToken</code>  String  accessToken received from api login
  <code>sessionId</code>  String  sessionId received from api login</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">persistToken</span></span> = (accessToken, sessionId) -&gt;

  <span class="property">@accesstoken</span> = <span class="keyword">if</span> <span class="keyword">typeof</span> <span class="property">@accesstoken</span> == <span class="string">"undefined"</span> <span class="keyword">then</span> accessToken <span class="keyword">else</span> <span class="property">@accesstoken</span>
  <span class="property">@sessionId</span> = <span class="keyword">if</span> <span class="keyword">typeof</span> <span class="property">@sessionId</span> == <span class="string">"undefined"</span> <span class="keyword">then</span> sessionId <span class="keyword">else</span> <span class="property">@sessionId</span>
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2>mGive::login</h2>
<p>login to mGive API and get accessToken/sessionId </p>
<p>  <code>username</code>  String  required username
  <code>password</code>  String  required password</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">login</span></span> = (username, password) -&gt;

  <span class="property">@op</span> = <span class="string">"login"</span>
  <span class="property">@username</span> = username <span class="comment"># user login..</span>
  <span class="property">@password</span> = password <span class="comment"># user pass used to login</span>
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h2>mGive::GetPollCampaigns</h2>
<p>This function returns the poll campaign for the account associated with the user</p>
<p>  <code>accessToken</code>  String  accessToken received from api login
  <code>sessionId</code>  String  sessionId received from api login</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">GetPollCampaigns</span></span> = (accessToken, sessionId)-&gt;

  <span class="property">@op</span> = <span class="string">"GetPollCampaigns"</span>
  <span class="property">@accesstoken</span> = accessToken
  <span class="property">@sessionId</span> = sessionId
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h2>mGive::GetPollQuestions</h2>
<p>This function takes a given poll ID (as returned from GetPollCampaigns) 
and returns the poll questions for that poll</p>
<p>  <code>accessToken</code>  String  accessToken received from api login
  <code>sessionId</code>  String  sessionId received from api login</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">GetPollQuestions</span></span> = (accessToken, sessionId, campaignId) -&gt;

  <span class="property">@op</span> = <span class="string">"GetPollQuestions"</span>
  <span class="property">@accesstoken</span> = accessToken
  <span class="property">@sessionId</span> = sessionId
  <span class="property">@CampaignID</span> = campaignId
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h2>mGive::GetQuestionResponses</h2>
<p>This function gets the responses for a given open-ended question. 
Optionally, you can filter by response status</p>
<p>  <code>accessToken</code>  String  accessToken received from api login
  <code>sessionId</code>  String  sessionId received from api login</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">GetQuestionResponses</span></span> = (type, accessToken, sessionId, campaignId) -&gt;

  <span class="property">@op</span> = <span class="string">"GetQuestionResponses"</span>
  <span class="property">@type</span> = type
  <span class="property">@accesstoken</span> = accessToken
  <span class="property">@sessionId</span> = sessionId
  <span class="property">@CampaignID</span> = campaignId
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2>mGive::GetAnswerStats</h2>
<p>This function returns the answer counts for each poll question that is
NOT open-ended</p>
<p>  <code>accessToken</code>  String  accessToken received from api login
  <code>sessionId</code>  String  sessionId received from api login</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">GetAnswerStats</span></span> = (questionId, accessToken, sessionId) -&gt;

  <span class="property">@op</span> = <span class="string">"GetAnswerStats"</span>
  <span class="property">@questionId</span> = questionId
  <span class="property">@accesstoken</span> = accessToken
  <span class="property">@sessionId</span> = sessionId
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <h2>mGive::ApprovedQuestionResponses</h2>
<p>function returns approved question responses</p>
<p>  <code>accessToken</code>  String  accessToken received from api login
  <code>sessionId</code>  String  sessionId received from api login</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">ApprovedQuestionResponses</span></span> = (questionId, accessToken, sessionId, maxResults) -&gt;

  <span class="property">@op</span> = <span class="string">"ApprovedQuestionResponses"</span>
  <span class="property">@questionId</span> = questionId
  <span class="property">@accesstoken</span> = accessToken
  <span class="property">@sessionId</span> = sessionId
  <span class="property">@MaxResults</span> = maxResults
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h2>mGive::SetAutoApproveFlag</h2>
<p>This function sets the auto-approval flag for an open-ended poll question. If auto-approve is on, than</p>
<p> <code>accessToken</code>  String  accessToken received from api login
  <code>sessionId</code>  String  sessionId received from api login</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">SetAutoApproveFlag</span></span> = (autoApprove, pollQuestionId, accessToken, sessionId) -&gt;

  <span class="property">@op</span> = <span class="string">"SetAutoApproveFlag"</span>
  <span class="property">@autoApprove</span> = autoApprove
  <span class="property">@pollQuestionId</span> = pollQuestionId
  <span class="property">@accesstoken</span> = accessToken
  <span class="property">@sessionId</span> = sessionId
  @</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <h2>mGive::DenyQuestionResponse</h2>
<p>This function rejects responses of open-ended questions.</p>
<p>  <em>still wip..</em></p>
<p>  <code>accessToken</code>  String  accessToken received from api login
  <code>sessionId</code>  String  sessionId received from api login</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">DenyQuestionResponse</span></span> = -&gt;</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <h2>mGive::GetDonationTotal</h2>
<p>do GetDonationTotal stuff</p>
<p>  <code>registration</code>  Boolean  Set this to turn registration on or off</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>mGive::<span class="function"><span class="title">GetDonationTotal</span></span> = (username, password, campaignId, mobileNumber, startDate, endDate, accessToken) -&gt;

  <span class="property">@op</span> = <span class="string">"GetDonationTotal"</span>
  <span class="keyword">if</span> <span class="keyword">typeof</span> accesstoken == <span class="string">"undefined"</span> &amp;&amp; password != <span class="literal">null</span> || <span class="keyword">typeof</span> password != <span class="string">"undefined"</span>
    <span class="property">@username</span> = username
    <span class="property">@password</span> = password
  <span class="keyword">else</span> <span class="property">@accesstoken</span> = accessToken
  <span class="property">@CampaignID</span> = campaignId
  <span class="property">@mobileNumber</span> = mobileNumber
  @

module.exports = mGive</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
